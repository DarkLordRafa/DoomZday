<!DOCTYPE html>
<html>
	<head>
		<title>DoomZday - Survival Zombie Apocalipse Game</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable='no'">
		<meta http-equiv="X-UA-compatible" content="IE=Edge" />
		<meta name="description" content="Zombies, Game, Apocalipse, Survival, DoomZday, Online Game, Browser Game, Zumbis, Jogo, Jogo Online, Sobreviv√™ncia, Jogo de zumbi " />
		<link rel="stylesheet" href="assets/bootstrap5/css/bootstrap.min.css" type="text/css"/>
	</head>
	
	<body class="text-center d-flex flex-column align-items-center">
		
		
		<h2 class="mt-5">Usu√°rio:</h2>
		<h3 id="null-message">N√£o h√° usu√°rio</h3>
		<div class="w-50 text-start" id="user-info">
			<h3 class="mt-2" id="user-name"><span></span></h3>
			<h3 class="mt-2" id="user-age"><span></span></h3>
			<h3 class="mt-2" id="user-food"><span></span></h3>
		</div>
		<form class="form mt-3 d-flex flex-column align-items-center" action="">
			<input type="text" name="title_text" id="text" required placeholder="Adicione ou atualize o t√≠tulo" maxlength="10" />
			<button type="button" id="edit" class="btn btn-light mt-2 border-dark">
				Editar
			</button>
			<input type="submit" id="submit" value="Salvar" class="btn btn-primary mt-1" />
			<button type="button" id="load" class="btn btn-light mt-1 border-dark">
				Carregar
			</button>
			<button type="button" class="btn btn-danger mt-1" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
				Redefinir
			</button>
		</form>
		
		
		<!-- Modal -->
		<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
		  <div class="modal-dialog">
		    <div class="modal-content">
		      <div class="modal-header">
		        <h5 class="modal-title" id="staticBackdropLabel">Redefinir</h5>
		        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
		      </div>
		      <div class="modal-body">
		        Tem certeza de que quer deletar o usu√°rio?
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
		        <button type="button" class="btn btn-danger" id="reset">Deletar</button>
		      </div>
		    </div>
		  </div>
		</div>
		
		
		<script src="assets/bootstrap5/js/bootstrap.bundle.min.js" type="text/javascript">
		</script>
		<script type="text/javascript">
			const nullMessage = document.querySelector("#null-message");
			const userInfo = document.querySelector("#user-info");
			const userName = document.querySelector("#user-name span");
			const userAge = document.querySelector("#user-age span");
			const userFood = document.querySelector("#user-food span");
			const userNameInput = document.querySelector("#text");
			let savedUser;
			let newUser;
			
			function displayUserData(){
				userName.innerHTML = savedUser.userNameProp;
				userAge.innerHTML = savedUser.userAgeProp;
				userFood.innerHTML = savedUser.userFoodProp;
			}
			const checkNewUser = () =>{
				try{
					savedUser = JSON.parse(window.localStorage.getItem("user_key"));
					console.log(savedUser.userNameProp);
					newUser = false;
				}
				catch {
					savedUser = {
						userNameProp: "",
						userAgeProp: "",
						userFoodProp: "",
					};
					console.log(savedUser.userNameProp);
					newUser = true;
				}
				finally{
					if (newUser === true){
						userInfo.style.display ="none";
					}
					else{
						userInfo.style.display = "block";
						nullMessage.style.display = "none";
					}
					displayUserData();
				}
			}
			checkNewUser();
			const saveButton = document.querySelector("#submit");
			const loadButton = document.querySelector("#load");
			const resetButton = document.querySelector("#reset");
			
			function saveUser(){
				window.localStorage.setItem("user_key", JSON.stringify(savedUser));
				newUser = false;
				alert("Seu usu√°rio foi salvo. Agora voc√™ pode carreg√°-lo");
			}
			
			function loadUser(){
				if (newUser === false){
					savedUser = JSON.parse(window.localStorage.getItem("user_key"));
					displayUserData();
					alert("Usu√°rio carregado com sucesso üôÇ");
					console.log(savedUser.userNameProp);
					}
				else{
						alert("Nenhum usu√°rio foi encontrado.")
					}
			}
			
			function resetData(){
				window.localStorage.clear();
				location.reload();
			}

			function clearInput(){
				userNameInput.value = "";
			}
			
			saveButton.addEventListener("click", (click) => {
				if (userNameInput.value != ""){
				click.preventDefault();
				saveUser();
				}
			});
			loadButton.addEventListener("click", loadUser);
			resetButton.addEventListener("click", resetData);
		</script>
	</body>
</html>